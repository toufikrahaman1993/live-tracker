<!DOCTYPE html>
<html>
  <head>
    <title>Live Location Tracker</title>
    <style>
      #map {
        width: 100%;
        height: 500px;
      }
    </style>
    <!-- Load Google Maps JavaScript API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDXz_HA896RMdokROPsy67l-nx10x0RmvE"></script>
  </head>
  <body>
    <h2>üìç Live Location Tracker</h2>
    <p id="location">Waiting for location...</p>
    <div id="map"></div>

    <script>
      var map, marker, accuracyCircle, output = document.getElementById("location");

      function initMap(lat, lon, accuracy) {
        var userLocation = { lat: lat, lng: lon };
        map = new google.maps.Map(document.getElementById("map"), {
          zoom: 15,
          center: userLocation
        });
        marker = new google.maps.Marker({
          position: userLocation,
          map: map,
          title: "You are here üö∂‚Äç‚ôÇÔ∏è"
        });

        // Blue circle showing GPS accuracy
        accuracyCircle = new google.maps.Circle({
          strokeColor: "#4285F4",
          strokeOpacity: 0.8,
          strokeWeight: 2,
          fillColor: "#4285F4",
          fillOpacity: 0.35,
          map: map,
          center: userLocation,
          radius: accuracy
        });
      }

      function updateLocation(lat, lon, accuracy) {
        var newPos = { lat: lat, lng: lon };
        marker.setPosition(newPos);
        map.setCenter(newPos);
        accuracyCircle.setCenter(newPos);
        accuracyCircle.setRadius(accuracy);
      }

      if (navigator.geolocation) {
        navigator.geolocation.watchPosition(
          function (position) {
            var lat = position.coords.latitude;
            var lon = position.coords.longitude;
            var accuracy = position.coords.accuracy;

            output.innerHTML =
              "Latitude: " + lat.toFixed(6) +
              "<br>Longitude: " + lon.toFixed(6) +
              "<br>Accuracy: ¬±" + accuracy.toFixed(2) + " meters" +
              "<br><a href='https://www.google.com/maps?q=" + lat + "," + lon + "' target='_blank'>üåç View on Google Maps</a>";

            if (!map) {
              initMap(lat, lon, accuracy);
            } else {
              updateLocation(lat, lon, accuracy);
            }
          },
          function (error) {
            switch (error.code) {
              case error.PERMISSION_DENIED:
                output.innerHTML = "User denied the request for Geolocation.";
                break;
              case error.POSITION_UNAVAILABLE:
                output.innerHTML = "Location information is unavailable.";
                break;
              case error.TIMEOUT:
                output.innerHTML = "The request to get user location timed out.";
                break;
              case error.UNKNOWN_ERROR:
                output.innerHTML = "An unknown error occurred.";
                break;
            }
          },
          { enableHighAccuracy: true, maximumAge: 0 }
        );
      } else {
        output.innerHTML = "Geolocation is not supported by this browser.";
      }
    </script>
  </body>
</html>
